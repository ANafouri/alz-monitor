# Metric Alerts Details

The following metric alerts have been defined and can deployed within your landing zones via Azure Policy.

Placeholders have been added for future work which will define Alert Processing Rules, Action Groups.

## Alert Processing Rules

<<TBD>>

## Action Groups

<<TBD>>

## Metric Alerts Settings

The values shown for Aggregation, Operator, Threshold, WindowSize, Frequency and Severity have been derived from field and what we've seen from other customers, we encourage you to adjust these threshold to match your environment.


| AlertName                                                                                                                                                                                                                                                          | Component                                | Metric                                            | Aggregation   | Operator           | Threshold   | WindowSize   | Frequency   | Severity   | Verified   | <div style="width:240px">References</div>                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------|:-------------------------------------------------:|:-------------:|:------------------:|:-----------:|:------------:|:-----------:|:----------:|:----------:|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [[DINE] Deploy ExpressRoute Circuits Bgp Availability Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-ercir_bgpavailability_alert.bicep)                  | microsoft.network/expressroutecircuits   | BgpAvailability                                   | Average       | LessThan           | 90          | PT5M         | PT1M        | 0          | Y          | <br/>[Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries)                                                                                                                                                                                                                                               |
| [[DINE] Deploy ExpressRoute Circuits Arp Availability Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-ercir_arpavailability_alert.bicep)                  | microsoft.network/expressroutecircuits   | ArpAvailability                                   | Average       | LessThan           | 90          | PT5M         | PT1M        | 0          | Y          | <br/>[Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries)                                                                                                                                                                                                                                               |
| [[DINE] Deploy ExpressRoute Circuits QosDropBitsInPerSecond Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-ercir_qosdropsbitsin_alert.bicep)             | microsoft.network/expressroutecircuits   | QosDropBitsInPerSecond                            | Average       | GreaterThan        | 100         | PT5M         | PT1M        | 2          | N          | <br/>[Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries)                                                                                                                                                                                                                                               |
| [[DINE] Deploy ExpressRoute Circuits QosDropBitsOutPerSecond Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-ercir_qosdropsbitsout_alert.bicep)           | microsoft.network/expressroutecircuits   | QosDropBitsOutPerSecond                           | Average       | GreaterThan        | 100         | PT5M         | PT1M        | 2          | N          | <br/>[Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries)                                                                                                                                                                                                                                               |
| [[DINE] Deploy KeyVault Availability Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-kv_availability_alert.bicep)                                         | Microsoft.KeyVault/vaults                | Availability                                      | Average       | LessThan           | 90          | PT5M         | PT1M        | 1          | Y          | [Monitoring KeyVault Reference](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault-reference)<br>[Monitoring KeyVault](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault)<br>[KeyVault Insights Overview](https://docs.microsoft.com/en-us/azure/azure-monitor/insights/key-vault-insights-overview)                                                                                                                                           |
| [[DINE] Deploy KeyVault Capacity Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-kv_capacity_alert.bicep)                                                 | Microsoft.KeyVault/vaults                | SaturationShoebox                                 | Average       | GreaterThan        | 75          | PT5M         | PT1M        | 1          | Y          | [Monitoring KeyVault Reference](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault-reference)<br>[Monitoring KeyVault](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault)<br>[KeyVault Insights Overview](https://docs.microsoft.com/en-us/azure/azure-monitor/insights/key-vault-insights-overview)                                                                                                                                           |
| [[DINE] Deploy KeyVault Latency Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-kv_latency_alert.bicep)                                                   | Microsoft.KeyVault/vaults                | ServiceApiLatency                                 | Average       | GreaterThan        | 1000        | PT5M         | PT1M        | 3          | Y          | [Monitoring KeyVault Reference](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault-reference)<br>[Monitoring KeyVault](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault)<br>[KeyVault Insights Overview](https://docs.microsoft.com/en-us/azure/azure-monitor/insights/key-vault-insights-overview)                                                                                                                                           |
| [[DINE] Deploy KeyVault Requests Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-kv_requests_alert.bicep)                                                 | Microsoft.KeyVault/vaults                | ServiceApiResult                                  | Average       | GreaterThan        | dynamic     | PT5M         | PT1M        | 2          | Y          | [Monitoring KeyVault Reference](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault-reference)<br>[Monitoring KeyVault](https://docs.microsoft.com/en-us/azure/key-vault/general/monitor-key-vault)<br>[KeyVault Insights Overview](https://docs.microsoft.com/en-us/azure/azure-monitor/insights/key-vault-insights-overview)                                                                                                                                           |
| [[DINE] Deploy Automation Account TotalJob Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-aa_totaljob_alert.bicep)                                       | Microsoft.Automation/automationAccounts  | TotalJob                                          | Count         | GreaterThan        | 0           | PT5M         | PT1M        | 2          | N          | [Azure Automation Azure Monitor Metrics](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftautomationautomationaccounts)                                                                                                                                                                                                                                                                                                                               |
| [[DINE] Deploy AFW FirewallHealth Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-afw_firewallhealth_alert.bicep)                                         | Microsoft.Network/azureFirewalls         | FirewallHealth                                    | Average       | LessThan           | 90          | PT5M         | PT1M        | 0          | N          | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                                                                                                                                                                         |
| [[DINE] Deploy AFW SNATPortUtilization Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-afw_snatportutilization_alert.bicep)                               | Microsoft.Network/azureFirewalls         | SNATPortUtilization                               | Average       | GreaterThan        | 80          | PT5M         | PT1M        | 1          | N          | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                                                                                                                                                                         |
| [[DINE] Deploy VPNG  BGP Peer Status Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_bgppeerstatus_alert.bicep)                                      | microsoft.network/vpngateways            | BgpPeerStatus                                     | Total         | LessThan           | 1           | PT5M         | PT5M        |            | N          | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                                                                                                                                                                         |
| [[DINE] Deploy VPNG Ingress Packet Drop Mismatch Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_ingresspacketdropmismatch_alert.bicep)              | microsoft.network/vpngateways            | TunnelIngressPacketDropTSMismatch                 | Average       | GreaterThan        | dynamic     | PT5M         | PT5M        | 3          | N          | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                                                                                                                                                                         |
| [[DINE] Deploy VPNG Egress Packet Drop Count Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_egresspacketdropcount_alert.bicep)                      | microsoft.network/vpngateways            | TunnelEgressPacketDropCount                       | Total         | GreaterThan        | dynamic     | PT5M         | PT5M        | 3          | N          | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                                                                                                                                                                         |
| [[DINE] Deploy VPNG Ingress Packet Drop Count Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_ingresspacketdropcount_alert.bicep)                    | microsoft.network/vpngateways            | TunnelIngressPacketDropCount                      | Total         | GreaterThan        | dynamic     | PT5M         | PT5M        | 3          | N          | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                                                                                                                                                                         |
| [[DINE] Deploy VPNG Egress Packet Drop Mismatch Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_egresspacketdropmismatch_alert.bicep)                | microsoft.network/vpngateways            | TunnelEgressPacketDropTSMismatch                  | Total         | GreaterThan        | dynamic     | PT5M         | PT5M        | 3          | N          | [Overview of Azure Firewall logs and metrics](https://docs.microsoft.com/en-us/azure/firewall/logs-and-metrics#metrics)                                                                                                                                                                                                                                                                                                                                                                         |
| [[DINE] Deploy VNetG ExpressRoute CPU Utilization Alert'](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_expressroutecpuutilization_alert.bicep)          | microsoft.network/virtualNetworkGateways | ExpressRouteGatewayCpuUtilization                 | Average       | GreaterThan        | 90          | PT5M         | PT1M        | 1          | Y          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                                                                                                                    |
| DELETE [deploy-vnetg_bgppeerstatus_alert.bicep](https://github.com/Azure/alz-monitor/blob/7d0b925a53edf365cee4fae157131420ea29e8c9/Observability_L100/Deploy/policyDefinitions/deploy-vnetg_bgppeerstatus_alert.bicep)                                             | microsoft.network/virtualNetworkGateways | BgpPeerStatus                                     | Total         | LessThan           | 1           | PT5M         | PT5M        |            | N          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                                                                                                                    |
| [[DINE] Deploy VNetG ExpressRoute CPU Utilization Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_expressroutecpuutilization_alert.bicep)           | microsoft.network/expressroutegateways   | ExpressRouteGatewayCpuUtilization                 | Average       | GreaterThan        | 80          | PT5M         | PT1M        | 1          | Y          | [ExpressRoute Monitoring Metrics Alerts for ExpressRoute Gateways](https://docs.microsoft.com/en-us/azure/expressroute/expressroute-monitoring-metrics-alerts#expressroute-gateways)                                                                                                                                                                                                                                                                                                            |
| [[DINE] Deploy PDNSZ Capacity Utilization Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pdnsz_capacityutilization_alert.bicep)                          | Microsoft.Network/privateDnsZones        | VirtualNetworkLinkCapacityUtilization             | Maximum       | GreaterThanEqualTo | 80          | PT1H         | PT1H        | 2          | N          | https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkprivatednszones                                                                                                                                                                                                                                                                                                                                                                               |
| [[DINE] Deploy PDNSZ Query Volume Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pdnsz_queryvolume_alert.bicep)                                          | Microsoft.Network/privateDnsZones        | QueryVolume                                       | Total         | GreaterThanOrEqual | 500         | PT1H         | PT1H        | 4          | N          | https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkprivatednszones                                                                                                                                                                                                                                                                                                                                                                               |
| [[DINE] Deploy PDNSZ Record Set Capacity Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pdnsz_recordsetcapacity_alert.bicep)                             | Microsoft.Network/privateDnsZones        | RecordSetCapacityUtilization                      | Maximum       | GreaterThanOrEqual | 75          | PT1H         | PT1H        | 2          | N          | https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkprivatednszones                                                                                                                                                                                                                                                                                                                                                                               |
| [[DINE] Deploy PDNSZ Registration Capacity Utilization Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pdnsz_registrationcapacityutilization_alert.bicep) | Microsoft.Network/privateDnsZones        | VirtualNetworkWithRegistrationCapacityUtilization | Maximum       | GreaterThan        | 90          | PT1H         | PT1H        | 2          | N          | https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkprivatednszones                                                                                                                                                                                                                                                                                                                                                                               |
| [[DINE] Deploy PIP Bytes in DDoS Attack Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pip_bytesinddosattack_alert.bicep)                                | Microsoft.Network/publicIPAddresses      | bytesinddos                                       | Maximum       | GreaterThan        | 8000000     | PT5M         | PT5M        | 4          | Y          | [Monitor Public IP Addresses](https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/monitor-public-ip#alerts<br><br>[[Public IP Addresses Supported Metrics](https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses)<br><br>[Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses) |
| [[DINE] Deploy PIP Bytes in DDoS Attack Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pip_ddosattack_alert.bicep)                                       | Microsoft.Network/publicIPAddresses      | ifunderddosattack                                 | Maximum       | GreaterThan        | 1           | PT5M         | PT5M        | 1          | Y          | [Monitor Public IP Addresses](https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/monitor-public-ip#alerts<br><br>[[Public IP Addresses Supported Metrics](https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses)<br><br>[Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses) |
| [[DINE] Deploy PIP Packets in DDoS Attack Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pip_packetsinddos_alert.bicep)                                  | Microsoft.Network/publicIPAddresses      | PacketsInDDoS                                     | Total         | GreaterThanEqualTo | 40000       | PT5M         | PT5M        | 4          | Y          | [Monitor Public IP Addresses](https://learn.microsoft.com/en-us/azure/virtual-network/ip-services/monitor-public-ip#alerts<br><br>[[Public IP Addresses Supported Metrics](https://learn.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses)<br><br>[Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses) |
| [[DINE] Deploy PIP VIP Availability Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-pip_vipavailability_alert.bicep)                                      | Microsoft.Network/publicIPAddresses      | VipAvailability                                   | Average       | LessThan           | 1           | PT5M         | PT5M        | 1          | N          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkpublicipaddresses)                                                                                                                                                                                                                                                                                                         |
| [[DINE] Deploy VNet DDoS Attack Alert](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnet_ddosattack_alert.bicep)                                                             | Microsoft.Network/virtualNetworks        | ifunderddosattack                                 | Maximum       | GreaterThanOrEqual | 1           | PT5M         | PT5M        | 1          | N          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworks)                                                                                                                                                                                                                                                                                                           |
| DELETE [deploy-vnet_pingavgroundtrip_alert.bicep](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnet_pingavgroundtrip_alert.bicep)                             | Microsoft.Network/virtualNetworks        | PingMeshAverageRoundtripMs                        | Average       | GreaterThan        | 300         | PT5M         | PT5M        | 4          | N          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworks)                                                                                                                                                                                                                                                                                                           |
| DELETE[deploy-vnetg_tunnelbandwidth_alert.bicep](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_tunnelbandwidth_alert.bicep)                              | Microsoft.Network/virtualNetworkGateways | TunnelAverageBandwidth                            | Average       | LessThan           | 1           | PT5M         | PT5M        | 0          | N          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                                                                                                                    |
| DELETE [[DINE] Deploy VNetG Tunnel Egress Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_egress_alert.bicep)                                       | Microsoft.Network/virtualNetworkGateways | TunnelEgressBytes                                 | Average       | LessThanOrEqual    | 1           | PT5M         | PT5M        | 0          | N          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                                                                                                                    |
| [[DINE] Deploy VNetG Tunnel Ingress Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_ingress_alert.bicep)                                            | Microsoft.Network/virtualNetworkGateways | TunnelIngressBytes                                | Average       | LessThanOrEqual    | 1           | PT5M         | PT5M        | 0          | N          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                                                                                                                    |
| [[DINE] Deploy VPNG Bandwidth Utilization Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_bandwidthutilization_alert.bicep)                          | microsoft.network/vpngateways            | tunnelaveragebandwidth                            | Average       | GreaterThan        | 1000000000  | PT5M         | PT5M        | 0          | N          | [Monitor VPN Gateway](https://learn.microsoft.com/en-us/azure/vpn-gateway/monitor-vpn-gateway)<br><br>[Monitor VPN Gateway Reference]https://learn.microsoft.com/en-us/azure/vpn-gateway/monitor-vpn-gateway-reference[<br><br>Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvpngateways)                                                                                 |
| [[DINE] Deploy VPNG Egress Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_egress_alert.bicep)                                                       | microsoft.network/vpngateways            | tunnelegressbytes                                 | Total         | LessThanOrEqual    | 0           | PT5M         | PT5M        | 0          | N          | [Monitor VPN Gateway](https://learn.microsoft.com/en-us/azure/vpn-gateway/monitor-vpn-gateway)<br><br>[Monitor VPN Gateway Reference]https://learn.microsoft.com/en-us/azure/vpn-gateway/monitor-vpn-gateway-reference[<br><br>Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvpngateways)                                                                                 |
| [[DINE] Deploy VPNG Ingress Alert](https://github.com/Azure/alz-monitor/blob/8297cc47b5d68fc42abb7fbd4eecd5bcbc5da6a8/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vpng_ingress_alert.bicep)                                                     | microsoft.network/vpngateways            | tunnelingressbytes                                | Total         | LessThanOrEqual    | 0           | PT5M         | PT5M        | 0          | N          | [Monitor VPN Gateway](https://learn.microsoft.com/en-us/azure/vpn-gateway/monitor-vpn-gateway)<br><br>[Monitor VPN Gateway Reference]https://learn.microsoft.com/en-us/azure/vpn-gateway/monitor-vpn-gateway-reference[<br><br>Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvpngateways)                                                                                 |
| [[DINE] Deploy VPNG Ingress Packet Drop Mismatch Alert](https://github.com/Azure/alz-monitor/blob/fdd0ab013ee6f35a53e130384734e20c0a722b54/Observability_L100/Deploy/policyDefinitions/deploy-vpng_ingresspacketdropmismatch_alert.bicep)                          | Microsoft.Network/virtualNetworkGateways | TunnelIngressPacketDropTSMismatch                 | Average       | GreaterThan        | 100         | PT5M         | PT5M        | 3          | N          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                                                                                                                    |
| [[DINE] Deploy VNetG Egress Packet Drop Mismatch Alert](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_egresspacketdropmismatch_alert.bicep)                             | Microsoft.Network/virtualNetworkGateways | TunnelEgressPacketDropCount                       | Average       | GreaterThan        | 100         | PT5M         | PT5M        | 3          | N          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                                                                                                                    |
| [[DINE] Deploy VNetG Ingress Packet Drop Count Alert](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_ingresspacketdropcount_alert.bicep)                                 | Microsoft.Network/virtualNetworkGateways | TunnelIngressPacketDropCount                      | Average       | GreaterThan        | 100         | PT5M         | PT5M        | 3          | N          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                                                                                                                    |
| [[DINE] Deploy VNetG Egress Packet Drop Mismatch Alert](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_egresspacketdropmismatch_alert.bicep)                             | Microsoft.Network/virtualNetworkGateways | TunnelEgressPacketDropTSMismatch                  | Average       | GreaterThan        | 100         | PT5M         | PT5M        | 3          | N          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                                                                                                                    |
| [[DINE] Deploy VNetG ExpressRoute Bits Per Second Alert](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-vnetg_expressroutebitspersecond_alert.bicep)                           | Microsoft.Network/virtualNetworkGateways | ExpressRouteGatewayBitsPerSecond                  | Average       | LessThanOrEqual    | 1           | PT5M         | PT5M        | 0          | N          | [Azure Monitor supported metrics by resource type - Azure Monitor](https://docs.microsoft.com/en-us/azure/azure-monitor/essentials/metrics-supported#microsoftnetworkvirtualnetworkgateways)                                                                                                                                                                                                                                                                                                    |
| [[DINE] Deploy ERG ExpressRoute Bits In Alert](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-erg_bitsinpersecond_alert.bicep)                                                 | microsoft.network/expressroutegateways   | ERGatewayConnectionBitsInPerSecond                | Average       | LessThanOrEqual    | 1           | PT5M         | PT5M        | 0          | N          | [ExpressRoute Monitoring Metrics Alerts - ExpressRoute-Gateways](https://docs.microsoft.com/en-us/azure/expressroute/expressroute-monitoring-metrics-alerts#expressroute-gateways)                                                                                                                                                                                                                                                                                                              |
| [[DINE] Deploy ERG ExpressRoute Bits Out Alert](https://github.com/Azure/alz-monitor/blob/arm-conversion-2023-01-26/src/resources/Microsoft.Authorization/policyDefinitions/deploy-erg_bitsoutpersecond_alert.bicep)                                               | microsoft.network/expressroutegateways   | ERGatewayConnectionBitsOutPerSecond               | Average       | LessThanOrEqual    | 1           | PT5M         | PT5M        | 0          | N          | [ExpressRoute Monitoring Metrics Alerts - ExpressRoute-Gateways](https://docs.microsoft.com/en-us/azure/expressroute/expressroute-monitoring-metrics-alerts#expressroute-gateways)                                                                                                                                                                                                                                                                                                              |


## Activity Log Alerts


### Activity Log Resource Health

| Alert Policy Name                                                                                                                                                                                                                                    | Name                         | targetScope     | Category       | Property.cause                      | Properties.currentHealthStatus   | Documented   | <div style="width:240px">References</div>                                                          |
|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------|:---------------:|:--------------:|:------------------------------------|:--------------------------------:|:------------:|:---------------------------------------------------------------------------------------------------|
| [[DINE] Deploy Resource Health Unhealthy Alert](https://github.com/Azure/alz-monitor/blob/448ad43ea7546d6994adde800020abe34b8b4356/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-ResourceHealth-UnHealthly-alert.bicep) | ResourceHealthUnhealthyAlert | managementGroup | ResourceHealth | PlatformInitiated,<br>UserInitiated | Degraded,<br>Unavailable         | Y            | [Resource Health](https://learn.microsoft.com/en-us/azure/service-health/resource-health-overview)<br> [Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |
### Activity Log Service Health

| Component                                                                                                                                                                                                                                          | PolicyScope     | Category      | properties.incidentType   | Documented   | <div style="width:240px">References</div>                                                                                                                                                                                                                             |
|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------:|:-------------:|:-------------------------:|:------------:|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [[DINE] Deploy Service Health Advisory Alert](https://github.com/Azure/alz-monitor/blob/448ad43ea7546d6994adde800020abe34b8b4356/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-ServiceHealth-Health.bicep)            | managementGroup | ServiceHealth | ActionRequired            | Y            | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br><br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |
| [[DINE] Deploy Service Health Incident Alert](https://github.com/Azure/alz-monitor/blob/448ad43ea7546d6994adde800020abe34b8b4356/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-ServiceHealth-Incident.bicep)          | managementGroup | ServiceHealth | Incident                  | Y            | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br><br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |
| [[DINE] Deploy Service Health Maintenance Alert](https://github.com/Azure/alz-monitor/blob/448ad43ea7546d6994adde800020abe34b8b4356/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-ServiceHealth-Maintenance.bicep)    | managementGroup | ServiceHealth | Maintenance               | Y            | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br><br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |
| [[DINE] Deploy Service Health Security Advisory Alert](https://github.com/Azure/alz-monitor/blob/448ad43ea7546d6994adde800020abe34b8b4356/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-ServiceHealth-Security.bicep) | managementGroup | ServiceHealth | Security                  | Y            | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br><br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |

### Activity Log Administrative

| Component                                                                                                                                                                                                                              | PolicyScope     | category       | operationName                        | status    | Documented   | <div style="width:240px">References</div>                                                                                                                                                                                                                             |
|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------:|:--------------:|:------------------------------------:|:---------:|:------------:|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| [[DINE] Deploy Activity Log VPN Gateway Delete Alert](https://github.com/Azure/alz-monitor/blob/448ad43ea7546d6994adde800020abe34b8b4356/src/resources/Microsoft.Authorization/policyDefinitions/deploy-activitylog-VPNGate-Del.bicep) | managementGroup | Administrative | Microsoft.Network/vpnGateways/delete | succeeded | N            | [Activity Log Service Notifications](https://learn.microsoft.com/en-us/azure/service-health/alerts-activity-log-service-notifications-portal)<br><br>[Best practices for setting up service health alerts](https://www.microsoft.com/en-us/videoplayer/embed/RE2OtUa) |

## Log Alerts


| Component | Metric |<div style="width:300px">Query</div> | Aggregator | Operator | Threshold | WindowSize | Frequency | Dimensions | Mandatory | Documented |<div style="width:240px">References</div>|
|:----------|:------:|:------|:----------:|:--------:|:---------:|:----------:|:---------:|:----------:|:---------:|:----------:|:---------------------------------------|
| microsoft.network/expressroutecircuits | BgpAvailability         |`AzureMetrics`<br/>`| where MetricName == "BgpAvailability"`<br/> `| summarize by Average, bin(TimeGenerated, 5m), Resource` <br/> `| render timechart` |0       | LessThan    | 90  | PT5M | PT1M |  Peer | No | Y | [Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries) |
| microsoft.network/expressroutecircuits | ArpAvailability         |`AzureMetrics`<br/>`| where MetricName == "ArpAvailability"`<br/> `| summarize by Average, bin(TimeGenerated, 5m), Resource` <br/> `| render timechart` |Average | LessThan    | 90  | PT5M | PT1M |  Peer | No | Y | [Monitor ExpressRoute Alerts](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#alerts)<br/>[ExpressRoute KQL Queries](https://docs.microsoft.com/en-us/azure/expressroute/monitor-expressroute#sample-kusto-queries) |
| microsoft.network/expressroutecircuits | BitsInPerSecond  |`AzureMetrics`<br/> `| where MetricName == "BitsInPerSecond"` <br/> `| summarize by Average, bin(TimeGenerated, 1h), Resource` <br/> `| render timechart` |Average | GreaterThan | 100 | PT5M | PT1M | No    | No | N |                                                                                                                                                                                                                                                         |
| microsoft.network/expressroutecircuits | BitsOutPerSecond |```AzureMetrics | where MetricName == "BitsInPerSecond"| summarize by Average, bin(TimeGenerated, 1h), Resource| render timechart``` |Average | GreaterThan | 100 | PT5M | PT1M | No    | No | N |
| microsoft.network/expressroutecircuits | QosDropBitsInPerSecond | `AzureMetrics| where MetricName == "QosDropBitsInPerSecond"` <br/> `| summarize by Average, bin(TimeGenerated, 1h), Resource` <br/> `| render timechart` | Average | GreaterThan | 100 | PT5M | PT1M | No    | No | N |
| microsoft.network/expressroutecircuits | QosDropBitsOutPerSecond | ```AzureMetrics | where MetricName == "QosDropBitsInPerSecond" | summarize by Average, bin(TimeGenerated, 1h), Resource | render timechart```  | Average | GreaterThan | 100 | PT5M | PT1M | No    | No | N |






